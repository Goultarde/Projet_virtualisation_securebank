# Diagrammes d'Architecture - SecureBank

## 1. Architecture Globale

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           INFRASTRUCTURE SÉCURISÉE                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   NTP Server    │    │   PKI Server    │    │  SecureBank     │         │
│  │ 192.168.56.42   │    │ 192.168.56.41   │    │ 192.168.56.40   │         │
│  │                 │    │                 │    │                 │         │
│  │ • NTP Service   │    │ • CFSSL API     │    │ • HAProxy       │         │
│  │ • Time Sync     │    │ • Certificates  │    │ • SSL/TLS       │         │
│  │ • Security      │    │ • PKI Mgmt      │    │ • WAF Rules     │         │
│  │ • Logs          │    │ • Auto Renewal  │    │ • Load Balance  │         │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘         │
│           │                       │                       │                 │
│           └───────────────────────┼───────────────────────┘                 │
│                                   │                                         │
│  ┌─────────────────────────────────┼─────────────────────────────────────────┐
│  │                    RÉSEAU PRIVÉ VAGRANT (192.168.56.0/24)                │
│  └─────────────────────────────────┼─────────────────────────────────────────┘
│                                   │                                         │
│  ┌─────────────────────────────────┼─────────────────────────────────────────┐
│  │                        DOCKER COMPOSE STACK                              │
│  │                                                                           │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │
│  │  │ SecureBank  │  │  StoreAPI   │  │   SQL       │  │   MailDev   │     │
│  │  │   App       │  │             │  │  Server     │  │             │     │
│  │  │ Port: 1337  │  │ Port: 1338  │  │ Port: 1433  │  │ Port: 1080  │     │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │
│  │                                                                           │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                      │
│  │  │ SQL Server  │  │ Replication │  │   Backup    │                      │
│  │  │ Secondary   │  │   Agent     │  │   Agent     │                      │
│  │  │ Port: 1434  │  │             │  │             │                      │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                      │
│  └───────────────────────────────────────────────────────────────────────────┘
└─────────────────────────────────────────────────────────────────────────────┘
```

## 2. Flux de Données Sécurisés

### 2.1 Flux d'Authentification

```
┌─────────┐    HTTPS    ┌──────────┐    HTTP     ┌─────────────┐    ┌─────────────┐
│ Client  │ ──────────→ │ HAProxy  │ ──────────→ │ SecureBank  │ ──→ │ SQL Server  │
│ Browser │             │ (SSL/TLS)│             │   App       │    │   Database  │
└─────────┘             └──────────┘             └─────────────┘    └─────────────┘
     │                        │                        │                    │
     │                        │                        │                    │
     ▼                        ▼                        ▼                    ▼
Validation              Headers Sec              Session Mgmt         Encryption
     │                        │                        │                    │
     │                        │                        │                    │
     └────────────────────────┼────────────────────────┼────────────────────┘
                              │                        │
                              ▼                        ▼
                        Rate Limiting            Cookie Creation
                              │                        │
                              ▼                        ▼
                        WAF Protection           Hash Generation
```

### 2.2 Flux de Transactions

```
┌─────────┐    HTTPS    ┌──────────┐    HTTP     ┌─────────────┐    ┌─────────────┐
│ Client  │ ──────────→ │ HAProxy  │ ──────────→ │ SecureBank  │ ──→ │  StoreAPI   │
│ Browser │             │ (SSL/TLS)│             │   App       │    │             │
└─────────┘             └──────────┘             └─────────────┘    └─────────────┘
     │                        │                        │                    │
     │                        │                        │                    │
     ▼                        ▼                        ▼                    ▼
User Input              Load Balance             Auth Check           API Validation
     │                        │                        │                    │
     │                        │                        │                    │
     └────────────────────────┼────────────────────────┼────────────────────┘
                              │                        │
                              ▼                        ▼
                        SSL Termination           Business Logic
                              │                        │
                              ▼                        ▼
                        Security Headers          Data Processing
```

## 3. Architecture de Sécurité

### 3.1 Couches de Sécurité

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              CLIENT LAYER                                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │   Browser   │  │   Mobile    │  │     API     │  │   Admin     │       │
│  │   HTTPS     │  │     App     │  │   Client    │  │   Panel     │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            NETWORK LAYER                                    │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │   Firewall  │  │   Router    │  │   Switch    │  │   Load      │       │
│  │   Rules     │  │   ACLs      │  │   VLANs     │  │  Balancer   │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           PERIMETER LAYER                                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │   HAProxy   │  │   WAF       │  │   DDoS      │  │   SSL/TLS   │       │
│  │   Reverse   │  │   Rules     │  │ Protection  │  │ Termination │       │
│  │   Proxy     │  │             │  │             │  │             │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           APPLICATION LAYER                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │ SecureBank  │  │  StoreAPI   │  │   Auth      │  │   Session   │       │
│  │   App       │  │             │  │   Service   │  │   Mgmt      │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            DATA LAYER                                       │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │ SQL Server  │  │   Backup    │  │ Encryption  │  │   Audit     │       │
│  │ Primary     │  │   System    │  │   at Rest   │  │   Logs      │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Infrastructure PKI

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              PKI INFRASTRUCTURE                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                           CFSSL SERVER                                  │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ │
│  │  │   CA Root   │  │   CA Int    │  │   API       │  │   Config    │   │ │
│  │  │ Certificate │  │ Certificate │  │   Server    │  │   Files     │   │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                    │                                         │
│                                    ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        CERTIFICATE MANAGEMENT                           │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ │
│  │  │   CSR       │  │   Signing   │  │   Renewal   │  │   Revoke    │   │ │
│  │  │ Generation  │  │   Process   │  │   Scripts   │  │   Process   │   │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                    │                                         │
│                                    ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                           HAProxy Integration                           │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ │
│  │  │   Cert      │  │   Key       │  │   Chain     │  │   Reload    │   │ │
│  │  │   Bundle    │  │   Files     │  │   Files     │  │   Process   │   │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 4. Monitoring et Logging

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           MONITORING STACK                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │   HAProxy   │  │  SecureBank │  │  StoreAPI   │  │   SQL       │       │
│  │   Stats     │  │   Logs      │  │   Logs      │  │  Server     │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
│         │                │                │                │               │
│         └────────────────┼────────────────┼────────────────┘               │
│                          │                │                                │
│                          ▼                ▼                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        LOG AGGREGATION                                  │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ │
│  │  │   Access    │  │   Error     │  │   Security  │  │   Audit     │   │ │
│  │  │   Logs      │  │   Logs      │  │   Events    │  │   Trails    │   │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                    │                                         │
│                                    ▼                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        ALERTING SYSTEM                                  │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ │
│  │  │   Email     │  │   SMS       │  │   Slack     │  │   Dashboard │   │ │
│  │  │   Alerts    │  │   Alerts    │  │   Notify    │  │   Monitoring│   │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 5. Plan de Déploiement

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           DEPLOYMENT PHASES                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  PHASE 1: PREPARATION (Week 1)                                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │   Security  │  │   Document  │  │   Planning  │  │   Training  │       │
│  │   Audit     │  │   Vulnerab. │  │   Infra     │  │   Team      │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
│                                                                             │
│  PHASE 2: INFRASTRUCTURE (Week 2-3)                                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │   Deploy    │  │   Configure │  │   Install   │  │   Setup     │       │
│  │   VMs       │  │   PKI       │  │   HAProxy   │  │   Replicat. │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
│                                                                             │
│  PHASE 3: APPLICATIONS (Week 4)                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │   Container │  │   Configure │  │   Security  │  │   Document  │       │
│  │   Apps      │  │   Env Vars  │  │   Tests     │  │   Procedures│       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
│                                                                             │
│  PHASE 4: VALIDATION (Week 5)                                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐       │
│  │   Penetrat. │  │   Compliance│  │   User      │  │   Production│       │
│  │   Tests     │  │   Audit     │  │   Training  │  │   Rollout   │       │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘       │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

**Ces diagrammes illustrent l'architecture complète de l'infrastructure sécurisée SecureBank** 